<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>View Schedule</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/view.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-r5gAtH1dLlI9HRvQILfmEis97zyZI7XGAAFPwOJXUJwn3rs6c5ISq9b6YQAd2MdazcVTPrjJ3L2QF5oaA9KCC5YRqj24KabbdFmCS0eKRz/11zZtg0R+CefFw98bJHIW3y/XsmF5lu3g8lJ8Uq7tsn44NXlMyDdf8tvwggstTnYGgA7d+sy/i9h+8Kck2J4jNYFv3HyAizn5eh5TAId9jOwCe5StZFyNXdY3vj/9rvo4Lv9B8T6EPx8y+9HX6d+Ds/3IMp5ARp6lA0RC5E+ZuoAaiKEvWIp2RIOlp0dVes4ARnbTjQKtqKce61tPCtwkY6ipHE2+dxyv1COAPnErJMp0IdZF+Ga2OL06S6MlA2O9GJFo89NXft/laTs7BgnA1zDUTMbR8b5byBokZgEVj+gibGYEe8AVcKWJDInQj8KcGDNn0A4DTt1DckdfYxbl0ZfkqzJQm11yzqy9Y9CTnxJW7W2DEMLh3ftJqCmgxgNQ5GiWZODPfKfI5gFjps5fTI2VqCJkFZ7AiZfnU2vTI7FUsUyjBHzq9Lz+9FdFqjclTUQy7Cb1VTYRdFO7FwjoOtdJnH2u/nlQ2fW/mFzpMqJdcY5R6j3Jt8nO92BPrFNerPvff9CpSVu5pBC8T7k7b+h5m4iZRL55G8XVR0P8QSHslOAYAzljlRpZjT7bQjQ2jDrfUpdXqIhiE9lYzw/+TsMLD1PfrMxP82PTYPswLPg+jBsZ/s8vMfJv8LHDtYreor+YBPd36ad+72XuNPnfdK4KAwEAANszOTczNzY0MTYwODkyMzA2NDM4MjY0Mjg5NzEzOTIwMzAzNjI2NTQ5MjA3MjYwNDI0OTQ0NjA0NzM3NDA5NzUwMzEwNTU0MjQxNTE1MDQ1MDY5NTM0MTI3NjA2MDIyMjkwNzI2MzUwNzEyMTUwNDE2MDEzNzAzMDA4MjAwNzQwMTM1MTEwNjA4NTczMzkwNzQxODk4NjEwMDk3NjA3NjE5NzYwNTQxNzE5MzYyMTYwNzU4ODQwOTM2MTE2MjEzNDk4ODA5Mjg1MTYyNzUxMDY4NzQwNjUxODk5MTQ2ODgxODU4ODQzNzQwMjU3MjI0MzUxMDY4NjI1MTU1MjQ3NjQ0ODc0MzU2NjAzNTA2ODI4MzA2NTM0NDE4NjU2MjU2MzQ3MjY0ODIwNjUwOTUxNTg1NTQzNDA5OTMwMzI2NzU2NjAzMzg2MzA0Njk0MTk4NjkzMTU2Mjg3NDM0MjQ2MzkxMDE2MjM0OTY0NjA3NjAzNTA5MzYyMjM4NTUyMjUxMzUxMzE4NzYxMjI3MDcyMTIzNTEyMjM4NjIwNTMyNDY5MTA1NDI1MzYzNDE4NzU2NzE0NTczODczMDY2MzkwMTM5NjE1ODM1Mjk1MjEwMzIxMTQzNTUyMDU4NzA0NTQ2NjA3MjY3NTA4Njk1NjYzMDA2NjEwMzQzMTQ3NTg3NTY1NjkwNDU4MTk2MTQ3OTM2NTIyMzY2NjY1MTQ4NTcyNjg1NzQyNzYwMjcyNjQ0NzYxMzkwMDUwNjg3NjMzODQyMTMzNzQyMjQ5Mjk2Nzg2Njk5NjUwMTU5OTk5NzMyNjgyMTIwNDA0MTU5MzUxMjAzMjM4NDY5MDQ3Nzg5NzQyMzYwMjY2MjkwMzczNDM4MjY2NjMyNTI4MjE4MzAzNzQzMDA0MTYwMzk2ODcyMTg1NjU4MTg5OTg3NjY4ODg1MDIwMjI4ODA4MjYxMTI3OTQwNjUyMzUxOTQ0MDYxMTUxMDMyMDIxMDQ5NzM5NTIyMjA4ODc4ODMwMTM4MTE0MTE5NDI0MDYxNTE1MDIzNTIxMzQyMjAzOTIwNjM1Njg4MjYwMzAzNjA4NjY5NzUxMzk2MDczMDQ2Nzg1OTQ">
    <script src="https://kit.fontawesome.com/b99e675b6e.js"></script>
</head>

<body>

    <div class="wrapper">
        <div class="sidebar">
            <h2>Sidebar</h2>
            <ul>
                <li><a href="nav.html"><i class="fas fa-home"></i>Dashboard</a></li>
                <li><a href="employee_profile.html"><i class="fas fa-user"></i>Crew Profile</a></li>
                <li><a href="change_password.html"><i class="fas fa-address-card"></i>Change Password</a></li>
                <li class="active"><a href="viewschedule.html"><i class="fas fa-project-diagram"></i>View Schedule</a></li>
                <li><a href="#"><i class="fas fa-address-book"></i>Contact</a></li>
                <li><a href="index.html" onclick="return confirm('Are you sure you want to log out?')"><i class="fas fa-sign-out-alt"></i>Log Out</a></li>
            </ul>
            <div class="social_media">
                <a href="#"><i class="fab fa-facebook-f"></i></a>
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
            </div>
        </div>
        <div class="main_content">
            <div class="header">View Schedule</div>

            <div class="info">
                <!-- Button to Create Schedule -->
                <button onclick="location.href='createschedule.html'">Create Schedule</button>
                <!-- Search bar -->
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="Search...">
                    <button onclick="searchSchedule()">Search</button>
                </div>
                <!-- Display Crew Schedule Table -->
                <table id="scheduleTable">
                    <thead>
                        <tr>
                            <th>No</th>
                            <th>Full Name</th>
                            <th>Crew ID</th>
                            <th>Job Roles</th>
                            <th>Duty Time</th>
                            <th>Start Time</th>
                            <th>End Time</th>
                            <th>Edit</th>
                            <th>Delete</th>
                        </tr>
                    </thead>
                    <tbody id="scheduleBody">
                        <!-- Schedule list data -->
                    </tbody>
                </table>


            </div>
        </div>
    </div>

    <script>
        const existingData = localStorage.getItem('allSchedules');
        const allSchedules = existingData ? JSON.parse(existingData) : [];

        // ------- Display Data Function ----------
        function displayScheduleData(filteredData) {
            const scheduleTable = document.getElementById('scheduleTable');
            const scheduleBody = document.getElementById('scheduleBody');
            scheduleBody.innerHTML = '';

            const dataToDisplay = filteredData || allSchedules;

            dataToDisplay.forEach((schedule, index) => {
                const newRow = scheduleBody.insertRow();
                newRow.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${schedule.fullName}</td>
                    <td>${schedule.crewID}</td>
                    <td>${schedule.jobRoles}</td>
                    <td>${schedule.dutyTime}</td>
                    <td>${schedule.startTime}</td>
                    <td>${schedule.endTime}</td>
                    <td><button class="edit-button" onclick="editSchedule('${schedule.crewID}')">Edit</button></td>
                    <td><button class="delete-button" onclick="deleteSchedule('${schedule.crewID}')">Delete</button></td>
                `;
            });
        }

        // ------- Search Function ----------
        function searchSchedule() {
            const searchInput = document.getElementById('searchInput').value.toLowerCase();
            const filteredData = allSchedules.filter(schedule =>
                Object.values(schedule).some(value => value.toLowerCase().includes(searchInput))
            );

            displayScheduleData(filteredData);
        }


        // ------- Edit Function ----------
        function editSchedule(crewID) {
            const scheduleToEdit = allSchedules.find(schedule => schedule.crewID === crewID);

            if (scheduleToEdit) {
                sessionStorage.setItem('editSchedule', JSON.stringify(scheduleToEdit));
                window.location.href = 'editschedule.html';
            } else {
                alert('Schedule not found for editing.');
            }
        }
        // ------- Delete Function ----------
        function deleteSchedule(crewID) {
            const confirmDelete = confirm(`Are you sure you want to delete this schedule with Crew ID ${crewID}?`);
            if (confirmDelete) {
                const updatedSchedules = allSchedules.filter(schedule => schedule.crewID !== crewID);
                localStorage.setItem('allSchedules', JSON.stringify(updatedSchedules));
                displayScheduleData(updatedSchedules);
            }
        }
        displayScheduleData();
    </script>

</body>

</html>